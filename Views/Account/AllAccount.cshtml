@model IEnumerable<IllinoisProject.Models.Account>
<link rel="stylesheet" href="~/css/site.css" />
<!-- Add the profile icon code here -->
<div class="profile-icon">
    <a asp-controller="Account" asp-action="EditAccount">
        <img src="@User.FindFirst("ProfilePictureUrl")?.Value" alt="Profile Icon" class="profile-image">
    </a>
</div>
    <p>
        <a asp-controller="Account" asp-action="Register"> Add an account</a>
    </p>
<input type="text" id="searchInput" onkeyup="searchFunction()" placeholder="Search for users">
<br />

    <h3> All Account list</h3>
@{
    if(Model.Count() < 1)
    {
        <p>No accounts yet.</p>
    }
    else
    {
        <table border="1">
            <thead>
            <tr>
                <th> Account ID</th>
                <th> Picture</th>
                <th> Account Name</th>
                <th> Username</th>
                <th> Blog Posts</th>
                <th> Edit</th>
                <th> Delete</th>
            </tr>
            </thead>
            @{

                foreach(var account in Model)
                {
                    <tbody id="dataBody">
                    <tr>
                        <td>@account.Id</td>
                            <td><a asp-action="DisplayPictures" asp-route-id="@account.Picture">Picture</a></td>
                        <td>@account.Name</td>
                        <td>@account.UserName</td>
                            <td>
                                @foreach (var blogPost in account.BlogPosts)
                                {
                                    <div>
                                        @blogPost.BlogName
                                    </div>
                                }
                            </td>
                        <td><a asp-action="AddFriend" asp-route-id="@account.Id">Add</a></td>
                        <td><a asp-action="EditAccount" asp-route-id="@account.Id">Edit</a></td>
                            <td><a asp-action="DeleteAccount" asp-route-id="@account.Id">Delete</a></td>
                    </tr>
                    </tbody>
                }
            }
        </table>
        <script>
            function searchFunction() {
                var input, filter, rows, i, txtValue;
                input = document.getElementById("searchInput");
                filter = input.value.trim().toUpperCase();
                rows = document.querySelectorAll("#dataBody tr");

                for (i = 0; i < rows.length; i++) {
                    var row = rows[i];
                    var cells = row.getElementsByTagName("td");
                    var rowMatch = false;

                    for (var j = 0; j < cells.length; j++) {
                        txtValue = cells[j].textContent || cells[j].innerText;

                        if (txtValue.trim().toUpperCase().indexOf(filter) > -1) {
                            rowMatch = true;
                            break; // If any cell in the row matches, display the entire row
                        }
                    }

                    if (rowMatch) {
                        row.style.display = "";
                    } else {
                        row.style.display = "none";
                    }
                }
            }
        </script>
    }
}